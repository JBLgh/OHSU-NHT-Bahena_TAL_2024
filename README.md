# **OHSU-NHT-Bahena_TAL_2024**
This project analyzes single-cell RNA sequencing (sc-RNAseq) data from mouse kidney thick ascending limb (TAL) cells.<br>
TAL cells play a critical role in monovalent and divalent cation transport. Through clustering, differential expression analysis, and visualization, this project aims to identify distinct TAL cell types and their underlying mechanisms.
<br>
## **Features**
âœ¨ Comprehensive analysis of mouse TAL sc-RNAseq data.  
âœ¨ Automated clustering and cell-type annotation.  
âœ¨ Publication-ready figures for zonation and DEG analysis.
<br><br>

|**Article Description**                                                               |**Link**                                                                                           
|---------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
| ðŸ§¬ Distinct TAL cell types reveal mechanisms of monovalent and divalent cation transport | [`ðŸ“„ Preprint Article`](https://www.biorxiv.org/content/10.1101/2025.01.16.633282v1) |
<br>

## **Pre-Processing Steps**
1. **Dataset Loading**  
   - Download the dataset from [PubMed](https://pubmed.ncbi.nlm.nih.gov/31689386/) and load it using `Seurat::Read10X`.

2. **Object Creation**  
   - Create a Seurat object and normalize the data using `SCTransform`.

3. **Dimensionality Reduction**  
   - Perform PCA and UMAP for clustering and visualization.

4. **Clustering**  
   - Group TAL cells using `FindNeighbors` and `FindClusters`.

5. **Subset Clusters**  
   - Extract specific TAL clusters for detailed analysis.

---

## **How to Use**
1. **Set Up the Environment**<br>
   Use `renv` to install the required R packages:
   ```R
   renv::restore()
   ```

2. **Run Preprocessing**<br>
   Preprocess raw datasets:
   ```R
   source("scripts/preprocess_data.R")
   ```

3. **Perform Analysis**<br>
   Perform clustering and DEG analysis:
    ```R
    source("scripts/run_analysis.R")
    ```

4. **Generate Figures**<br>
   Create publication-ready visualizations:
   ```R
   source("scripts/generate_figures.R")
   ```

5. **Explore Data Interactively**<br>
   Open the R Markdown notebooks in <code>notebooks/</code> using RStudio for exploratory data analysis or visualization:
   - Exploratory Analysis: notebooks/exploratory_analysis.Rmd
   - Visualization: notebooks/visualization.Rmd

6. **View Outputs**<br>
   - Figures: Results saved in <code>results/figures/</code> (e.g., <code>UMAP_Zonation.tiff</code>).<br>
   - Tables: DEG results saved in <code>results/tables/</code> (e.g., <code>Mouse_TAL_DEG.xlsx</code>).<br>

## Project Directory Structure:
```
OHSU-NHT-Bahena_TAL_2024/
â”‚
â”œâ”€â”€ README.md                                      # Project documentation
â”œâ”€â”€ LICENSE                                        # Licensing information
â”‚
â”œâ”€â”€ data/                                          # Folder for datasets
â”‚      â”œâ”€â”€ raw/                                    # Raw datasets (downloaded files, original files)
â”‚      â””â”€â”€ processed/                              # Processed datasets for analysis (after running pre-processing scripts)
â”‚
â”œâ”€â”€ R/                                             # Custom R scripts/functions
â”‚      â”œâ”€â”€ preprocess.R                            # Data cleaning and transformation functions
â”‚      â”œâ”€â”€ analysis.R                              # Clustering and DEG analysis functions
â”‚      â”œâ”€â”€ visualization.R                         # Visualization functions (UMAP, violin plots, etc.)
â”‚      â””â”€â”€ utils.R                                 # Utility/helper functions (if needed)
â”‚
â”œâ”€â”€ scripts/                                       # Folder for analysis scripts
â”‚      â”œâ”€â”€ preprocess_data.R                       # Script for running data preprocessing
â”‚      â”œâ”€â”€ run_analysis.R                          # Script for clustering and DEG analysis
â”‚      â”œâ”€â”€ generate_figures.R                      # Script for generating publication-ready figures
â”‚
â”œâ”€â”€ results/                                       # Folder for results
â”‚      â”œâ”€â”€ figures/                                # Generated figures (UMAP, dot plots)
â”‚      â””â”€â”€ tables/                                 # Processed tables (DEG lists, Mouse_TAL_DEG.xlsx)
â”‚
â”œâ”€â”€ docs/                                          # Folder for documentation
â”‚      â””â”€â”€ MOUSE_Code_Explanation.md               # Explanatory Markdown files of code and methods
â”‚
â”œâ”€â”€ environment/                                   # Environment setup files
â”‚      â”œâ”€â”€ renv.lock                               # Lock file for R package dependencies (generated by renv)
â”‚      â”œâ”€â”€ renv/                                   # Folder for renv package management
â”‚      â””â”€â”€ session_info.txt                        # Record of R session information for reproducibility
â”‚
â””â”€â”€ notebooks/                                     # Interactive R Markdown notebooks
       â”œâ”€â”€ exploratory_analysis.Rmd                # Exploratory data analysis
       â””â”€â”€ visualization.Rmd                       # Visualization examples
```

## License
This project is licensed under the [MIT License](License)

